<!DOCTYPE html>
<html lang="en"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
	<meta charset="UTF-8" />
	<title>Document</title>
</head>
<body>
	<table th:fragment="target" class="table table-sm table-responsive single-table-schedule">
		<tbody class="table-bordered">
			<th:block th:each="day: ${days}">
					<tr>
						<td th:rowspan="${bells.size()*2}" th:text="#{__${day}__}"></td>
						<td rowspan="2">
							<div th:text="${bells[1]}" align="center"></div>
							<div align="center">1</div>
						</td>
						<td th:with="curSchedule=${schedules.get(day, 1, 'up')}"
							th:text="${curSchedule != null} ? ${curSchedule['subjectTitle']} : #{noLesson}">
							Subject title of first lesson of 'up' week
						</td>
					</tr>
					<tr>
						<td th:with="curSchedule=${schedules.get(day, 1, 'down')}"
							th:text="${curSchedule != null} ? ${curSchedule['subjectTitle']} : #{noLesson}">
							Subject title of first lesson of 'down' week
						</td>
					</tr>
					
					<!-- Here we display subjects from 2nd lesson to 6th lesson -->
					<th:block th:each="lessonNum: ${#numbers.sequence(2, __${bells.size()}__)}"
							  th:with="
							  	upSchedule=${schedules.get(day, lessonNum, 'up')},
							  	downSchedule=${schedules.get(day, lessonNum, 'down')}">
							<th:block th:if="${upSchedule != null || downSchedule != null}">
								<tr>
									<td rowspan="2">
										<div th:text="${bells[__${lessonNum}__]}" align="center"></div>
										<div th:text="${lessonNum+1}" align="center"></div>
									</td>
									<td th:with="curSchedule=${schedules.get(day, lessonNum, 'up')}"
										th:text="${curSchedule != null} ? ${curSchedule['subjectTitle']} : #{noLesson}">
										Up subject
									</td>
								</tr>
								<tr>
									<td th:with="curSchedule=${schedules.get(day, lessonNum, 'down')}"
										th:text="${curSchedule != null} ? ${curSchedule['subjectTitle']} : #{noLesson}">
										Down subject
									</td>
								</tr>
							</th:block>
							
							<th:block th:unless="${upSchedule != null || downSchedule != null}">
								<tr>
									<td rowspan="2">
										<div th:text="${bells[__${lessonNum}__]}"></div>
										<div th:text="${lessonNum}" align="center"></div>
									</td>
									<td th:text="#{noLesson}">Up subject</td>
								</tr>
								<tr>
									<td th:text="#{noLesson}">Down subject</td>
								</tr>
							</th:block>
					</th:block>
			</th:block>
		</tbody>
	</table>
</body>
</html>